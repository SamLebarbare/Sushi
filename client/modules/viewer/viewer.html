<section>
  <nav class="navbar navbar-default" role="navigation" style="background-color: white;">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">
          <i class="glyphicon glyphicon-leaf"></i> {{bud.title}}
        </a>
      </div>
      <div class="btn-group navbar-right" dropdown>
        <button type="button" class="btn btn-default navbar-btn">Actions</button>
        <button type="button" class="btn btn-default navbar-btn dropdown-toggle">
          <span class="caret"></span>
          <span class="sr-only">Split button!</span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li><a href="#" ng-click="editSubBud()" >Add a bud here</a></li>
          <li class="divider"></li>
          <li ng-if="canShare()"><a href="#" ng-click="share()">Share</a></li>
          <li ng-if="bud.creator.id == common.user.id"><a ui-sref="bud.editor({budId : bud.id})">Edit</a></li>
          <li class="divider"></li>
          <li><a ng-if="bud.creator.id == common.user.id && (!bud.subBuds || bud.subBuds.length == 0)" ng-click="delete()">Delete</a></li>
        </ul>
      </div>
    </div>
    <br>
    <tabset style="background-color: white;">
      <tab heading="Bud" ng-click="showType('Bud')">
        <br>
        <div class="clear-fix"></div>
        <div class="btn-group btn-group-xs">
          <button class="btn btn-danger" ng-click="followBud($event)" ng-disabled="bud.creator.id == common.user.id || actionInProgress">
              {{follower ? 'Unfollow' : 'Follow'}}
          </button>
          <button class="btn btn-group-xs" disabled>
              {{followersCount}} followers
          </button>
        </div>
        <div class="btn-group btn-group-xs">
          <button class="btn btn-primary" ng-click="sponsorBud($event)" ng-disabled="bud.creator.id == common.user.id || actionInProgress"><i class="glyphicon glyphicon-tint"></i>
            {{sponsorer ? 'Unsponsorize' : 'Sponsorize'}}
          </button>
          <button class="btn btn-default" disabled>
            {{sponsorsCount}} sponsors
          </button>
        </div>
        <div class="btn-group btn-group-xs">
          <button class="btn btn-success" ng-click="supportBud($event)" ng-disabled="bud.creator.id == common.user.id || actionInProgress">{{supporter ? 'Unsupport' : 'Support'}}</button>
          <rating class="btn btn-default"
          ng-model="supportValue"
          max="5"
          readonly="false"
          on-hover="hoveringOver(value)"
          on-leave="overStar = null"
          state-on="'glyphicon-leaf'"
          >
          </rating>
          <button class="btn btn-default" disabled>{{supportersCount}} supporters</button>
        </div>
        <div class="clear-fix"></div>
        <div style="background-color: white;" class="well" ng-bind-html="bud.content"></div>
      </tab>
      <tab ng-repeat="pack in bud.budPacksData" heading="{{pack.type}}" active="pack.active" disabled="pack.disabled" ng-click="showType(pack.type)">
        <br>
        <div class="clear-fix"></div>
        <div style="background-color: white;" class="well" ui-view="summary"></div>
      </tab>
      <tab ng-if="bud.creator.id == common.user.id" heading="Evolve...">
        <br>
        <table class="table table-hover">
          <tbody>
            <tr ng-repeat="type in common.availableTypes" ng-click="evolve(type.id)">
              <td><h1>{{type.id}}</h1></td>
              <td><small>{{type.desc}}</small></td>
            </tr>
          </tbody>
        </table>
      </tab>
    </tabset>
  </nav>
  <nav class="navbar navbar-default " role="navigation">
    <div class="container">
      <p class="navbar-text">Creator {{bud.creator.name}} <small></small></p>
      <p class="navbar-text navbar-right">{{bud.privacy}}</p>
    </div>
  </nav>
</section>

<script type="text/ng-template" id="sharebox.html">
    <div class="modal-header">
        <h3 class="modal-title">Sharebox</h3>
    </div>
    <div class="modal-body">
      Teams members from (click to add members):
      <div class="table-responsive">
        <table class="table table-hover">
          <tbody>
            <tr ng-repeat="team in teams"><td ng-click="addTeam(team)"><span><i class="fa fa-user"></i></span> {{ team.name }}</td></tr>
          </tbody>
        </table>
      </div>
      <div class="spacer visible-xs"></div>
      Available (click to add):
      <div class="table-responsive">
        <table class="table table-hover">
          <tbody>
            <tr ng-repeat="user in users"><td ng-click="addUser(user)"><span><i class="fa fa-user"></i></span> {{ user.name }}</td></tr>
          </tbody>
        </table>
      </div>
      <div class="spacer visible-xs"></div>
      Selected (click to remove):
      <div class="table-responsive">
        <table class="table table-hover">
          <tbody>
            <tr ng-repeat="user in selectedUsers"><td ng-click="rmUser(user)"><span><i class="fa fa-user"></i></span> {{ user.name }}</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" ng-click="ok()" ng-disabled="selectedUsers.length < 1" >Share</button>
        <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
    </div>
</script>
<!--
<div id="chart" class=""></div>
<script type="text/javascript">
//.event("click", function(d) self.location = "show?id="+d.id);

var w = 960,
  h = 100;
  fill = d3.scale.category20();

var vis = d3.select("#chart").append("svg:svg")
  .attr("width", w)
  .attr("height", h);
d3.json("", function(json) {
var force = d3.layout.force()
   .charge(-120)
   .linkDistance(30)
   .nodes(json.nodes)
   .links(json.links)
   .size([w, h])
   .start();

var link = vis.selectAll("line.link")
   .data(json.links)
   .enter().append("svg:line")
   .style("stroke","black")
   .attr("x1", function(d) { return d.source.x; })
   .attr("y1", function(d) { return d.source.y; })
   .attr("x2", function(d) { return d.target.x; })
   .attr("y2", function(d) { return d.target.y; });

var node = vis.selectAll("circle.node")
   .data(json.nodes)
 .enter().append("svg:circle")
   .attr("cx", function(d) { return d.x; })
   .attr("cy", function(d) { return d.y; })
   .attr("r", 8)
   .attr("rel","popover")
   .attr("data-content",function(d) { return d.content; })
   .attr("data-original-title",function(d) { return d.nodeName; })
   .style("fill", function(d) { return fill(d.group); })
   .call(force.drag);


node.on("click",function(d) { self.location = "show?id="+d.id; });

force.on("tick", function() {
 link.attr("x1", function(d) { return d.source.x; })
     .attr("y1", function(d) { return d.source.y; })
     .attr("x2", function(d) { return d.target.x; })
     .attr("y2", function(d) { return d.target.y; });

 node.attr("cx", function(d) { return d.x; })
     .attr("cy", function(d) { return d.y; });


});

});
</script>
<script type="text/javascript">
        $(function () {
          $("circle[rel=popover]")
            .popover({
              live: true,
              animate: false,
              html: true,
              placement: "above"
            })

        })
</script>
-->


<style type="text/css">
  /* Layout */

  .posts li {
    border-top: solid 1px #E9E9E9;
  }

  .post {
    margin-top: 0;
    padding-bottom: 18px;
    padding-top: 18px;
  }

  .post img {
    height: 50px;
    width: 50px;
  }

  .post-body h5 {
    margin: 0;
  }

  .post-tools {
    color: grey;
    display: block;
  }

  .post-comments li {
    background-color: #edeff4;
    border: none;
  }

  .post-comments li:first-child {
    background: none;
    line-height: 5px;
  }

  .post-comments li:nth-child(2) {
    margin-top: 0;
  }

  .post-comments li:nth-child(n + 3) {
    margin-top: 1px;
  }

  .post-comment {
    line-height: 13px;
    padding: 5px 5px 4px 5px;
  }

  .post-comment img {
    height: 32px;
    width: 32px;
  }

  .post-comment > .pull-left {
    margin-right: 8px;
  }

  .post-comment .comment-box {
  }

  .post-comment-body textarea {
    resize: vertical;
    height: 20px;
    width: 75%;
    margin: 0;
    padding-top: 1px;
    padding-bottom: 0;
    font-size: 12px;
    border-radius: 2px;
  }

  .post-comment-tools {
    color: gray;
    display: block;
    line-height: 16px;
    padding-top: 2px;
  }
</style>
