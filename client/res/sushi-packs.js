!function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="./res/",n(0)}([function(module,exports,__webpack_require__){eval("__webpack_require__(41);\n__webpack_require__(42);\n\n__webpack_require__(31);\n__webpack_require__(32);\n\n__webpack_require__(35);\n__webpack_require__(36);\n\n__webpack_require__(19);\n__webpack_require__(20);\n\n__webpack_require__(27);\n__webpack_require__(28);\n\n__webpack_require__(23);\n__webpack_require__(24);\n\n__webpack_require__(39);\n__webpack_require__(40);\n\n__webpack_require__(25);\n__webpack_require__(26);\n\n__webpack_require__(29);\n__webpack_require__(30);\n\n__webpack_require__(37);\n__webpack_require__(38);\n\n__webpack_require__(21);\n__webpack_require__(22);\n\n__webpack_require__(33);\n__webpack_require__(34);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/packs-deps.js\n ** module id = 0\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/packs-deps.js?")},,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * Sushi project\r\n */\r\n\r\nangular\r\n    .module('sushi.org.actions', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Action', {\r\n            url: '/action',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-actions/view.html',\r\n                controller: 'ActionViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Action',\r\n              stateName: 'sushi.viewer.Action'\r\n            }\r\n          })\r\n          .state('sushi.editor.Action', {\r\n            url: '/action',\r\n            views: {\r\n              'summary':{\r\n                controller: 'ActionViewerCtrl',\r\n                templateUrl: 'sushiPacks/sushi-org-actions/view.html',\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Action Editor',\r\n              stateName: 'sushi.editor.Action'\r\n            }\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-actions/pack.js\n ** module id = 19\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-actions/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.actions').controller('ActionViewerCtrl',\r\nfunction ($scope, $state, $stateParams, api)\r\n{\r\n  console.log(\"ActionViewerCtrl start...\");\r\n  var user        = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'Free',\r\n    actor: undefined\r\n  };\r\n\r\n  var afterLoad = function (done) {\r\n    //Parent state apply\r\n    $scope.startParentIfNeeded ('Project');\r\n\r\n    //Inner state management\r\n    $scope.getPackData(function (packData)\r\n    {\r\n      if(packData.state) {\r\n        $scope.packData = packData;\r\n        console.log('packdata found:' + packData);\r\n        if($scope.packData.state === 'Ended') {\r\n          $scope.endPackData ($scope.packData, done);\r\n        } else {\r\n          done ();\r\n        }\r\n      } else {\r\n        $scope.createPackData ($scope.packData, done);\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-actions/view-controller.js\n ** module id = 20\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-actions/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n/**\r\n * Sushi Info\r\n */\r\n\r\nangular\r\n    .module('sushi.org.customers', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Customer', {\r\n            url: '/customer',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-customers/view.html',\r\n                controller: 'CustomerViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Customer',\r\n              stateName: 'sushi.viewer.Customer'\r\n            },\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-customers/pack.js\n ** module id = 21\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-customers/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.customers').controller('CustomerViewerCtrl',\r\nfunction ($scope, $state, $stateParams, $location, api)\r\n{\r\n  var user       = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'New'\r\n  };\r\n\r\n  var afterLoad = function (done) {\r\n    $scope.getPackData (function (packData)\r\n    {\r\n      if(packData.state) {\r\n        $scope.packData = packData;\r\n        done ();\r\n      } else {\r\n        $scope.createPackData ($scope.packData, done);\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-customers/view-controller.js\n ** module id = 22\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-customers/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n/**\r\n * Sushi Idea\r\n */\r\n\r\nangular\r\n    .module('sushi.org.ideas', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Idea', {\r\n            url: '/idea',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-ideas/view.html',\r\n                controller: 'IdeaViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Idea',\r\n              stateName: 'sushi.viewer.Idea'\r\n            },\r\n          })\r\n          .state('sushi.editor.Idea', {\r\n            url: '/idea',\r\n            views: {\r\n              'summary':{\r\n                controller: 'IdeaEditorCtrl',\r\n                templateUrl: 'sushiPacks/sushi-org-ideas/edit.html',\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Idea Editor',\r\n              stateName: 'sushi.editor.Idea'\r\n            },\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-ideas/pack.js\n ** module id = 23\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-ideas/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.ideas').controller('IdeaViewerCtrl',\r\nfunction ($scope, $state, $stateParams, $location, api)\r\n{\r\n  var user       = $scope.common.user;\r\n  $scope.packData = {\r\n    actor: undefined,\r\n    state: 'Waiting',\r\n    selectedSushi: null\r\n  };\r\n  var afterLoad = function (done) {\r\n    api.sushis.sushiPacksData.get($scope.sushi.id, 'Idea')\r\n    .success(function (packData)\r\n      {\r\n\r\n        var trySetEnded = function () {\r\n          if($scope.packData.selectedSushi) {\r\n            if($scope.packData.selectedSushi.dataCache.state === 'Ended') {\r\n              $scope.packData.state = 'Primed';\r\n              api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Idea');\r\n              done ();\r\n            }\r\n          }\r\n        };\r\n\r\n        if(packData.state) {\r\n          $scope.packData = packData;\r\n          console.log('packdata found:' + packData);\r\n          if ($scope.sushi.sponsors) {\r\n            if ($scope.sushi.sponsors.length > 0){\r\n              $scope.packData.state = 'Sponsored';\r\n              api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Idea');\r\n            }\r\n            done ();\r\n          } else {\r\n            $scope.packData.state = 'Waiting';\r\n            api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Idea');\r\n          }\r\n\r\n          api.sushis.childrenByType ($scope.sushi.id, 'Mission')\r\n          .success(function (missions)\r\n          {\r\n            if(missions.length > 0)\r\n            {\r\n              $scope.packData.state = 'Selected';\r\n              $scope.packData.selectedSushi = missions[0];\r\n              trySetEnded ();\r\n            } else {\r\n              api.sushis.childrenByType ($scope.sushi.id, 'Project')\r\n              .success(function (projects)\r\n              {\r\n                if(projects.length > 0)\r\n                {\r\n                  $scope.packData.state = 'Selected';\r\n                  $scope.packData.selectedSushi = projects[0];\r\n                  trySetEnded ();\r\n                } else {\r\n                  api.sushis.childrenByType ($scope.sushi.id, 'Action')\r\n                  .success(function (actions)\r\n                  {\r\n                    if(actions.length > 0)\r\n                    {\r\n                      $scope.packData.state = 'Selected';\r\n                      $scope.packData.selectedSushi = actions[0];\r\n                      trySetEnded ();\r\n                    }\r\n                  });\r\n                }\r\n              });\r\n            }\r\n          });\r\n\r\n          done ();\r\n        } else {\r\n          api.sushis.sushiPacksData.create($scope.sushi.id, $scope.packData, 'Idea');\r\n          done ();\r\n        }\r\n      })\r\n      .error(function ()\r\n    {\r\n      console.log('error while loading packdata');\r\n      done ();\r\n    });\r\n\r\n    api.sushis.sponsorsChanged.subscribe($scope, function (sushi) {\r\n      if ($scope.sushi.id === sushi.id)\r\n      {\r\n        if (sushi.sponsors.length > 0) {\r\n          $scope.packData.state = 'Sponsored';\r\n          api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Idea');\r\n        } else {\r\n          $scope.packData.state = 'Waiting';\r\n          api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Idea');\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n\r\n\r\n\r\n\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-ideas/view-controller.js\n ** module id = 24\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-ideas/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n/**\r\n * Sushi Info\r\n */\r\n\r\nangular\r\n    .module('sushi.org.infos', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Info', {\r\n            url: '/idea',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-infos/view.html',\r\n                controller: 'InfoViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Info',\r\n              stateName: 'sushi.viewer.Info'\r\n            },\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-infos/pack.js\n ** module id = 25\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-infos/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.infos').controller('InfoViewerCtrl',\r\nfunction ($scope, $state, $stateParams, $location, api)\r\n{\r\n  var user       = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'Unshared',\r\n    selectedSushi: null\r\n  };\r\n  var afterLoad = function (done) {\r\n    api.sushis.sushiPacksData.get($scope.sushi.id, 'Info')\r\n    .success(function (packData)\r\n      {\r\n        var trySetEnded = function () {\r\n          if($scope.packData.selectedSushi) {\r\n            if($scope.packData.selectedSushi.dataCache.state === 'Ended') {\r\n              $scope.packData.state = 'Primed';\r\n              api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Info');\r\n              done ();\r\n            }\r\n          }\r\n        };\r\n\r\n        if(packData.state) {\r\n          $scope.packData = packData;\r\n          console.log('packdata found:' + packData);\r\n\r\n          if ($scope.shareCount > 0) {\r\n            $scope.packData.state = 'Shared';\r\n          } else {\r\n            $scope.packData.state = 'Unshared';\r\n          }\r\n          if ($scope.sushi.sponsors) {\r\n            if ($scope.sushi.sponsors.length > 0){\r\n              $scope.packData.state = 'Relevant';\r\n            }\r\n          }\r\n\r\n          api.sushis.childrenByType ($scope.sushi.id, 'Mission')\r\n          .success(function (missions)\r\n          {\r\n            if(missions.length > 0)\r\n            {\r\n              $scope.packData.state = 'Selected';\r\n              $scope.packData.selectedSushi = missions[0];\r\n              trySetEnded ();\r\n            } else {\r\n              api.sushis.childrenByType ($scope.sushi.id, 'Project')\r\n              .success(function (projects)\r\n              {\r\n                if(projects.length > 0)\r\n                {\r\n                  $scope.packData.state = 'Selected';\r\n                  $scope.packData.selectedSushi = projects[0];\r\n                  trySetEnded ();\r\n                } else {\r\n                  api.sushis.childrenByType ($scope.sushi.id, 'Action')\r\n                  .success(function (actions)\r\n                  {\r\n                    if(actions.length > 0)\r\n                    {\r\n                      $scope.packData.state = 'Selected';\r\n                      $scope.packData.selectedSushi = actions[0];\r\n                      trySetEnded ();\r\n                    }\r\n                  });\r\n                }\r\n              });\r\n            }\r\n          });\r\n          api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Info');\r\n          done ();\r\n        } else {\r\n          api.sushis.sushiPacksData.create($scope.sushi.id, $scope.packData, 'Info');\r\n          done ();\r\n        }\r\n      })\r\n      .error(function ()\r\n    {\r\n      console.log('error while loading packdata');\r\n      done ();\r\n    });\r\n\r\n    api.sushis.sharesChanged.subscribe($scope, function (sushi) {\r\n      if ($scope.sushi.id === sushi.id)\r\n      {\r\n        $scope.load (afterLoad);\r\n      }\r\n    });\r\n\r\n    api.sushis.sponsorsChanged.subscribe($scope, function (sushi) {\r\n      if ($scope.sushi.id === sushi.id)\r\n      {\r\n        $scope.load (afterLoad);\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n\r\n\r\n\r\n\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-infos/view-controller.js\n ** module id = 26\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-infos/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * Sushi project\r\n */\r\n\r\nangular\r\n    .module('sushi.org.issues', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Issue', {\r\n            url: '/Issue',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-issues/view.html',\r\n                controller: 'IssueViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Issue',\r\n              stateName: 'sushi.viewer.Issue'\r\n            }\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-issues/pack.js\n ** module id = 27\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-issues/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.issues').controller('IssueViewerCtrl',\r\nfunction ($scope, $state, $stateParams, api)\r\n{\r\n  console.log(\"IssueViewerCtrl start...\");\r\n  var user        = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'Free',\r\n    actor: undefined,\r\n    actions: []\r\n  };\r\n\r\n  var afterLoad = function (done) {\r\n    $scope.getPackData (function (packData)\r\n    {\r\n      if(packData.state) {\r\n        $scope.packData = packData;\r\n        api.sushis.childrenByType ($scope.sushi.id, 'Action').success(function (actions) {\r\n          $scope.packData.state = 'ActionsInProgress';\r\n          $scope.packData.actions = actions;\r\n\r\n          if($scope.packData.actions.length > 0) {\r\n            var ended = true;\r\n            angular.forEach ($scope.packData.actions, function (action) {\r\n              console.log ('a');\r\n              if(action.dataCache.state !== 'Ended') {\r\n                $scope.packData.state = 'ActionsInProgress';\r\n                ended = false;\r\n                $scope.savePackData ($scope.packData, done);\r\n              }\r\n            });\r\n            if(ended) {\r\n              $scope.packData.state = 'Ended';\r\n              $scope.endPackData ($scope.packData, done);\r\n            }\r\n          } else {\r\n            $scope.savePackData ($scope.packData, done);\r\n          }\r\n        });\r\n        done ();\r\n      } else {\r\n        $scope.createPackData ($scope.packData, done);\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-issues/view-controller.js\n ** module id = 28\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-issues/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * Sushi Meeting\r\n */\r\n\r\nangular\r\n    .module('sushi.org.meetings', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Meeting', {\r\n            url: '/Meeting',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-meetings/view.html',\r\n                controller: 'MeetingViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Meeting',\r\n              stateName: 'sushi.viewer.Meeting'\r\n            },\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-meetings/pack.js\n ** module id = 29\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-meetings/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.meetings').controller('MeetingViewerCtrl',\r\nfunction ($scope, $state, $stateParams, $location, api)\r\n{\r\n  var user             = $scope.common.user;\r\n  $scope.itemsByPage   = 10;\r\n  $scope.displayedSushis = [];\r\n  $scope.displayedSushis4Meeting = [];\r\n  $scope.packData = {\r\n    participations : [],\r\n    sushis: [],\r\n    state: 'Waiting'\r\n  };\r\n\r\n  var afterLoad = function (done) {\r\n    api.users.list().success(function (users)\r\n    {\r\n      $scope.users = users;\r\n      api.sushis.list().success(function (sushis)\r\n      {\r\n        $scope.sushis = sushis;\r\n        _.remove($scope.sushis, function(b) { return b.id === $scope.sushi.id; });\r\n        $scope.displayedSushis = [].concat($scope.sushis);\r\n\r\n        $scope.getPackData (function (packData)\r\n        {\r\n          if(packData.state) {\r\n            $scope.packData = packData;\r\n            console.log('packdata found:' + packData);\r\n            $scope.packData.participations.forEach (function (p){\r\n              _.remove($scope.users, function(u) { return u.id === p.user.id; });\r\n            });\r\n            $scope.packData.sushis.forEach (function (sushi){\r\n              _.remove($scope.sushis, function(b) { return b.id === sushi.id; });\r\n            });\r\n            $scope.displayedSushis4Meeting = [].concat($scope.packData.sushis);\r\n            $scope.savePackData ($scope.packData, done);\r\n          } else {\r\n            $scope.createPackData ($scope.packData, done);\r\n          }\r\n          done ();\r\n        });\r\n      });\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n\r\n  $scope.startMeeting = function () {\r\n    $scope.packData.state = 'Started';\r\n    $scope.displayedSushis4Meeting = [].concat($scope.packData.sushis);\r\n    $scope.savePackData ($scope.packData, null);\r\n  };\r\n\r\n  $scope.finishMeeting = function () {\r\n    $scope.packData.state = 'Finished';\r\n    var scope = $scope;\r\n    scope.packData.participations.forEach ( function (p) {\r\n      api.links.deleteU2B(p.user.id,'INVITED',scope.sushi.id);\r\n    });\r\n    $scope.endPackData ($scope.packData, null);\r\n  };\r\n\r\n  $scope.addSushiToMeeting = function (sushi) {\r\n    $scope.packData.sushis.push (sushi);\r\n    $scope.displayedSushis4Meeting = [].concat($scope.packData.sushis);\r\n    _.remove($scope.sushis, function(b) { return b.id === sushi.id; });\r\n    $scope.savePackData ($scope.packData, null);\r\n  };\r\n\r\n  $scope.removeSushiFromMeeting = function (sushi) {\r\n    _.remove($scope.packData.sushis, function(b) { return b.id === sushi.id; });\r\n    $scope.displayedSushis4Meeting = [].concat($scope.packData.sushis);\r\n    $scope.sushis.push (sushi);\r\n    $scope.displayedSushis4Meeting = [].concat($scope.packData.sushis);\r\n    $scope.savePackData ($scope.packData, null);\r\n  };\r\n\r\n  $scope.canSetParticipantState = function (participantId) {\r\n    return participantId === user.id;\r\n  };\r\n\r\n  $scope.setParticipantState = function (userId, state) {\r\n    var participation = _.find($scope.packData.participations, function(p) { return p.user.id === userId; });\r\n    participation.state = state;\r\n    $scope.savePackData ($scope.packData, null);\r\n  };\r\n\r\n  $scope.addUser = function (user) {\r\n    var participation = {\r\n      state: 'Waiting',\r\n      user: user\r\n    };\r\n    $scope.packData.participations.push(participation);\r\n    _.remove($scope.users, function(u) { return u.id === user.id; });\r\n    $scope.savePackData ($scope.packData, null);\r\n    api.links.createU2B(user.id,'INVITED',$scope.sushi.id);\r\n  };\r\n\r\n  $scope.rmUser = function (user) {\r\n    $scope.users.push(user);\r\n    _.remove($scope.packData.participations, function(p) { return p.user.id === user.id; });\r\n    $scope.savePackData ($scope.packData, null);\r\n    api.links.deleteU2B(user.id,'INVITED',$scope.sushi.id);\r\n  };\r\n\r\n  // subscribe to websocket events to receive new sushis, comments, etc.\r\n  api.sushis.created.subscribe($scope, function (sushi)\r\n  {\r\n    // only add the sushi if we don't have it already in the sushis list to avoid dupes\r\n    if (!_.some($scope.sushis, function (b)\r\n    {\r\n      return b.id === sushi.id;\r\n    }))\r\n    {\r\n      $scope.sushis.unshift(sushi);\r\n      $scope.displayedSushis = [].concat($scope.sushis);\r\n    }\r\n  });\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-meetings/view-controller.js\n ** module id = 30\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-meetings/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * Sushi mission\r\n */\r\n\r\nangular\r\n    .module('sushi.org.missions', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Mission', {\r\n            url: '/mission',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-missions/view.html',\r\n                controller: 'MissionViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Mission',\r\n              stateName: 'sushi.viewer.Mission'\r\n            }\r\n          })\r\n          .state('sushi.editor.Mission', {\r\n            url: '/mission',\r\n            views: {\r\n              'summary':{\r\n                controller: 'MissionViewerCtrl',\r\n                templateUrl: 'sushiPacks/sushi-org-missions/view.html',\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Mission Editor',\r\n              stateName: 'sushi.editor.Mission'\r\n            }\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-missions/pack.js\n ** module id = 31\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-missions/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.missions').controller('MissionViewerCtrl',\r\nfunction ($scope, $state, $stateParams, api)\r\n{\r\n  console.log(\"MissionViewerCtrl start...\");\r\n  var user        = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'Waiting',\r\n    projects: [],\r\n    actor: undefined,\r\n    team: undefined\r\n  };\r\n  var afterLoad = function (done) {\r\n    $scope.getPackData (function (packData)\r\n    {\r\n      if(packData.state) {\r\n        $scope.packData = packData;\r\n        api.sushis.parentByType ($scope.sushi.id, 'Team').success(function (teams) {\r\n          if(teams.length > 0) {\r\n            $scope.packData.team = teams[0];\r\n          }\r\n          api.sushis.childrenByType ($scope.sushi.id, 'Project').success(function (projects) {\r\n            $scope.packData.projects = projects;\r\n            if(projects.length > 0)\r\n            {\r\n              $scope.packData.state = 'Started';\r\n              var scope = $scope;\r\n              angular.forEach(projects, function (project) {\r\n                if(project.dataCache.state === 'Ended') {\r\n                 scope.packData.state = 'Ended';\r\n                } else {\r\n                 scope.packData.state = 'Started';\r\n                }\r\n              });\r\n            } else {\r\n             $scope.packData.state = 'Waiting';\r\n            }\r\n            if($scope.packData.state === 'Ended') {\r\n              $scope.endPackData ($scope.packData, done);\r\n            } else {\r\n              $scope.savePackData ($scope.packData, done);\r\n            }\r\n          });\r\n        });\r\n      } else {\r\n        $scope.createPackData ($scope.packData, done);\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-missions/view-controller.js\n ** module id = 32\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-missions/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n/**\r\n * products\r\n */\r\n\r\nangular\r\n    .module('sushi.org.products', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Product', {\r\n            url: '/product',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-products/view.html',\r\n                controller: 'ProductViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Product',\r\n              stateName: 'sushi.viewer.Product'\r\n            },\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-products/pack.js\n ** module id = 33\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-products/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.products').controller('ProductViewerCtrl',\r\nfunction ($scope, $state, $stateParams, $location, api)\r\n{\r\n  var user       = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'New'\r\n  };\r\n\r\n  var afterLoad = function (done) {\r\n    $scope.getPackData (function (packData)\r\n    {\r\n      if(packData.state) {\r\n        $scope.packData = packData;\r\n        done ();\r\n      } else {\r\n        $scope.createPackData ($scope.packData, done);\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-products/view-controller.js\n ** module id = 34\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-products/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * Sushi project\r\n */\r\n\r\nangular\r\n    .module('sushi.org.projects', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Project', {\r\n            url: '/project',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-projects/view.html',\r\n                controller: 'ProjectViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Project',\r\n              stateName: 'sushi.viewer.Project'\r\n            }\r\n          })\r\n          .state('sushi.editor.Project', {\r\n            url: '/project',\r\n            views: {\r\n              'summary':{\r\n                controller: 'ProjectViewerCtrl',\r\n                templateUrl: 'sushiPacks/sushi-org-projects/view.html',\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Project Editor',\r\n              stateName: 'sushi.editor.Project'\r\n            }\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-projects/pack.js\n ** module id = 35\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-projects/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.projects').controller('ProjectViewerCtrl',\r\nfunction ($scope, $state, $stateParams, api)\r\n{\r\n  console.log(\"ProjectViewerCtrl start...\");\r\n  var user        = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'Waiting',\r\n    actor: undefined,\r\n    actions: []\r\n  };\r\n  var afterLoad = function (done) {\r\n    //Parent state apply\r\n    $scope.startParentIfNeeded ('Mission');\r\n\r\n    //Inner state management\r\n    $scope.getPackData (function (packData)\r\n    {\r\n      if(packData.state) {\r\n        $scope.packData = packData;\r\n        console.log('packdata found:' + packData);\r\n        api.sushis.childrenByType ($scope.sushi.id, 'Action')\r\n        .success(function (actions)\r\n          {\r\n            $scope.packData.actions = actions;\r\n            if(actions.length > 0)\r\n            {\r\n              $scope.packData.state = 'Started';\r\n              var scope = $scope;\r\n              angular.forEach(actions, function (action) {\r\n                if(action.dataCache.state === 'Ended') {\r\n                  scope.packData.state = 'Ended';\r\n                } else {\r\n                  scope.packData.state = 'Started';\r\n                }\r\n              });\r\n            } else {\r\n              $scope.packData.state = 'Waiting';\r\n            }\r\n            if($scope.packData.state === 'Ended') {\r\n              $scope.endPackData ($scope.packData, done);\r\n            } else {\r\n              $scope.savePackData ($scope.packData, done);\r\n            }\r\n          });\r\n      } else {\r\n        $scope.createPackData ($scope.packData, done);\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-projects/view-controller.js\n ** module id = 36\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-projects/view-controller.js?")
},function(module,exports,__webpack_require__){eval("'use strict';\r\n/**\r\n * regions\r\n */\r\n\r\nangular\r\n    .module('sushi.org.regions', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Region', {\r\n            url: '/region',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-regions/view.html',\r\n                controller: 'RegionViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Region',\r\n              stateName: 'sushi.viewer.Region'\r\n            },\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-regions/pack.js\n ** module id = 37\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-regions/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\n angular.module('sushi.org.regions').controller('RegionViewerCtrl',\r\n function ($scope, $state, $stateParams, $location, api)\r\n{\r\n  var user       = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'New'\r\n  };\r\n\r\n  var afterLoad = function (done) {\r\n    $scope.getPackData (function (packData)\r\n    {\r\n      if(packData.state) {\r\n        $scope.packData = packData;\r\n        done ();\r\n      } else {\r\n        $scope.createPackData ($scope.packData, done);\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-regions/view-controller.js\n ** module id = 38\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-regions/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * Sushi result\r\n */\r\n\r\nangular\r\n    .module('sushi.org.results', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Result', {\r\n            url: '/result',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-results/view.html',\r\n                controller: 'ResultViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Result',\r\n              stateName: 'sushi.viewer.Result'\r\n            }\r\n          })\r\n          .state('sushi.editor.Result', {\r\n            url: '/result',\r\n            views: {\r\n              'summary':{\r\n                controller: 'ResultViewerCtrl',\r\n                templateUrl: 'sushiPacks/sushi-org-results/view.html',\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Result Editor',\r\n              stateName: 'sushi.editor.Result'\r\n            }\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-results/pack.js\n ** module id = 39\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-results/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.results').controller('ResultViewerCtrl',\r\nfunction ($scope, $state, $stateParams, api)\r\n{\r\n  var user        = $scope.common.user;\r\n  $scope.packData = {\r\n    state: 'Undefined',\r\n    actor: undefined\r\n  };\r\n\r\n  var afterLoad = function (done) {\r\n    api.sushis.sushiPacksData.get($scope.sushi.id, 'Result')\r\n    .success(function (packData)\r\n      {\r\n        if(packData.state) {\r\n          $scope.packData = packData;\r\n          console.log('packdata found:' + packData);\r\n        } else {\r\n          api.sushis.sushiPacksData.create($scope.sushi.id, $scope.packData, 'Result');\r\n        }\r\n        done ();\r\n      })\r\n      .error(function ()\r\n    {\r\n      console.log('error while loading packdata');\r\n      done ();\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n  $scope.setSuccess = function ()\r\n  {\r\n    $scope.packData.state = 'Success';\r\n    api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Result');\r\n    if($scope.sushi.parentSushi) {\r\n      api.sushis.sushiPacksData.get($scope.sushi.parentSushi.id, 'Action')\r\n      .success(function (packData) {\r\n        packData.state = 'Ended';\r\n        api.sushis.sushiPacksData.set($scope.sushi.parentSushi.id, packData, 'Action');\r\n      });\r\n      api.sushis.sushiPacksData.get($scope.sushi.parentSushi.id, 'Issue')\r\n      .success(function (packData) {\r\n        packData.state = 'Ended';\r\n        api.sushis.sushiPacksData.set($scope.sushi.parentSushi.id, packData, 'Issue');\r\n      });\r\n    }\r\n  };\r\n\r\n  $scope.setFailed = function ()\r\n  {\r\n    $scope.packData.state = 'Failed';\r\n    api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Result');\r\n    if($scope.sushi.parentSushi) {\r\n      api.sushis.sushiPacksData.get($scope.sushi.parentSushi.id, 'Action')\r\n      .success(function (packData) {\r\n        api.links.deleteU2B(packData.actor.id,'ASSIGNED',$scope.sushi.parentSushi.id);\r\n        api.links.deleteU2B(packData.actor.id,'ACTOR',$scope.sushi.parentSushi.id);\r\n        packData.actor = undefined;\r\n        packData.state = 'Free';\r\n        api.sushis.sushiPacksData.set($scope.sushi.parentSushi.id, packData, 'Action');\r\n      });\r\n      api.sushis.sushiPacksData.get($scope.sushi.parentSushi.id, 'Issue')\r\n      .success(function (packData) {\r\n        api.links.deleteU2B(packData.actor.id,'ASSIGNED',$scope.sushi.parentSushi.id);\r\n        api.links.deleteU2B(packData.actor.id,'ACTOR',$scope.sushi.parentSushi.id);\r\n        packData.actor = undefined;\r\n        packData.state = 'Free';\r\n        api.sushis.sushiPacksData.set($scope.sushi.parentSushi.id, packData, 'Issue');\r\n      });\r\n\r\n    }\r\n  };\r\n\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-results/view-controller.js\n ** module id = 40\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-results/view-controller.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * Sushi Team\r\n */\r\n\r\nangular\r\n    .module('sushi.org.teams', [\r\n      'ui.router',\r\n      'ui.bootstrap',\r\n      'sushi.common'\r\n    ])\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n          .state('sushi.viewer.Team', {\r\n            url: '/team',\r\n            views: {\r\n              'summary':{\r\n                templateUrl: 'sushiPacks/sushi-org-teams/view.html',\r\n                controller: 'TeamViewerCtrl'\r\n              }\r\n            },\r\n            breadcrumb: {\r\n              class: 'highlight',\r\n              text: 'Sushi Team',\r\n              stateName: 'sushi.viewer.Team'\r\n            },\r\n          });\r\n    });\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-teams/pack.js\n ** module id = 41\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-teams/pack.js?")},function(module,exports,__webpack_require__){eval("'use strict';\r\n\r\n/**\r\n * __\r\n */\r\n\r\nangular.module('sushi.org.teams').controller('TeamViewerCtrl',\r\nfunction ($scope, $state, $stateParams, $location, api)\r\n{\r\n  var user       = $scope.common.user;\r\n  $scope.users    = [];\r\n  $scope.packData = {\r\n    members : [],\r\n    missions: [],\r\n  };\r\n  $scope.canEditTeam = function () {\r\n    return $scope.sushi.creator.id === user.id;\r\n  };\r\n  $scope.addUser = function (user) {\r\n    $scope.packData.members.push(user);\r\n    _.remove($scope.users, function(u) { return u.id === user.id; });\r\n    api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Team');\r\n    api.links.createU2B(user.id,'MEMBER',$scope.sushi.id);\r\n  };\r\n\r\n  $scope.rmUser = function (user) {\r\n    $scope.users.push(user);\r\n    _.remove($scope.packData.members, function(u) { return u.id === user.id; });\r\n    api.sushis.sushiPacksData.set($scope.sushi.id, $scope.packData, 'Team');\r\n    api.links.deleteU2B(user.id,'MEMBER',$scope.sushi.id);\r\n  };\r\n\r\n  var afterLoad = function (done) {\r\n    api.users.list().success(function (users)\r\n    {\r\n      $scope.users = users;\r\n\r\n      api.sushis.sushiPacksData.get($scope.sushi.id, 'Team')\r\n      .success(function (packData)\r\n      {\r\n\r\n        api.sushis.childrenByType ($scope.sushi.id, 'Mission')\r\n        .success(function (missions)\r\n        {\r\n          $scope.packData.missions = missions;\r\n        });\r\n\r\n        if(packData.members) {\r\n          $scope.packData = packData;\r\n          console.log('packdata found:' + packData);\r\n          $scope.packData.members.forEach (function (user){\r\n            _.remove($scope.users, function(u) { return u.id === user.id; });\r\n          });\r\n        } else {\r\n          api.sushis.sushiPacksData.create($scope.sushi.id, $scope.packData, 'Team');\r\n        }\r\n        done ();\r\n      })\r\n      .error(function ()\r\n      {\r\n        console.log('error while loading packdata');\r\n        done ();\r\n      });\r\n    });\r\n  };\r\n\r\n  $scope.load (afterLoad);\r\n});\r\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sushiPacks/sushi-org-teams/view-controller.js\n ** module id = 42\n ** module chunks = 2\n **/\n//# sourceURL=webpack:///./sushiPacks/sushi-org-teams/view-controller.js?")}]);